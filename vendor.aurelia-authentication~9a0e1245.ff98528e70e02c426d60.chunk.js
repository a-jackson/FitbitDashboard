(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{CyDa:function(e,t,o){"use strict";var n;t.__esModule=!0,t.AuthenticatedValueConverter=void 0;var i=o("3U8n"),r=o("aurelia-authentication");t.AuthenticatedValueConverter=(0,i.inject)(r.AuthService)(n=function(){function e(e){this.authService=e}return e.prototype.toView=function(){return this.authService.authenticated},e}())||n},"Med+":function(e,t,o){"use strict";var n;t.__esModule=!0,t.AuthenticatedFilterValueConverter=void 0;var i=o("3U8n"),r=o("aurelia-authentication");o("4ysu"),t.AuthenticatedFilterValueConverter=(0,i.inject)(r.AuthService)(n=function(){function e(e){this.authService=e}return e.prototype.toView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.authService.authenticated;return e.filter((function(e){return"boolean"!=typeof e.config.auth||e.config.auth===t}))},e}())||n},"aurelia-authentication":function(e,t,o){"use strict";(function(e){var n,i,r,s,a,u,c,p,h,l,g,d,f,k,y,T,v,m,R,b;t.__esModule=!0,t.FetchConfig=t.AuthorizeStep=t.AuthenticateStep=t.AuthService=t.Authentication=t.OAuth2=t.OAuth1=t.AuthLock=t.Storage=t.BaseConfig=t.logger=t.Popup=void 0;var A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();t.configure=function(e,t){P.PLATFORM.location.origin||(P.PLATFORM.location.origin=P.PLATFORM.location.protocol+"//"+P.PLATFORM.location.hostname+(P.PLATFORM.location.port?":"+P.PLATFORM.location.port:""));var o=e.container.get(V);"function"==typeof t?t(o):"object"===(void 0===t?"undefined":A(t))&&o.configure(t);var n=o.globalValueConverters,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var s;if(i){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;e.globalResources(P.PLATFORM.moduleName("./"+a)),q.info("Add globalResources value-converter: "+a)}var u=e.container.get(Z),c=e.container.get(E.Config);Array.isArray(o.configureEndpoints)&&o.configureEndpoints.forEach((function(e){u.configure(e)}));var p=void 0;if(null!==o.endpoint)if("string"==typeof o.endpoint){var h=c.getEndpoint(o.endpoint);if(!h)throw new Error("There is no '"+(o.endpoint||"default")+"' endpoint registered.");p=h}else o.endpoint instanceof D.HttpClient&&(p=new E.Rest(o.endpoint));p instanceof E.Rest||(p=new E.Rest(e.container.get(D.HttpClient)));o.client=p};var w=I(o("6dBs")),U=I(o("BOF4")),P=o("70NS"),j=o("iD3O"),C=o("MP1E"),S=o("3U8n"),F=o("qrcG"),_=o("aurelia-event-aggregator"),L=o("aurelia-templating-resources"),E=o("aurelia-api"),M=o("4ysu"),D=o("qQke");o("aurelia-authentication/authFilterValueConverter"),o("CyDa"),o("Med+");function I(e){return e&&e.__esModule?e:{default:e}}function z(e,t,o,n,i){var r={};return Object.keys(n).forEach((function(e){r[e]=n[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var B=t.Popup=function(){function t(){this.popupWindow=null,this.polling=null,this.url=""}return t.prototype.open=function(e,t,o){this.url=e;var n=x(o||{});return this.popupWindow=P.PLATFORM.global.open(e,t,n),this.popupWindow&&this.popupWindow.focus&&this.popupWindow.focus(),this},t.prototype.eventListener=function(t){var o=this;return new e((function(e,n){o.popupWindow.addEventListener("loadstart",(function(i){if(0===i.url.indexOf(t)){var r=P.DOM.createElement("a");if(r.href=i.url,r.search||r.hash){var s=N(r);s.error?n({error:s.error}):e(s),o.popupWindow.close()}}})),o.popupWindow.addEventListener("exit",(function(){n({data:"Provider Popup was closed"})})),o.popupWindow.addEventListener("loaderror",(function(){n({data:"Authorization Failed"})}))}))},t.prototype.pollPopup=function(){var t=this;return new e((function(e,o){t.polling=P.PLATFORM.global.setInterval((function(){var n=void 0;try{if(t.popupWindow.location.host===P.PLATFORM.global.document.location.host&&(t.popupWindow.location.search||t.popupWindow.location.hash)){var i=N(t.popupWindow.location);i.error?o({error:i.error}):e(i),t.popupWindow.close(),P.PLATFORM.global.clearInterval(t.polling)}}catch(e){n=e}t.popupWindow?t.popupWindow.closed&&(P.PLATFORM.global.clearInterval(t.polling),o({error:n,data:"Problem poll popup"})):(P.PLATFORM.global.clearInterval(t.polling),o({error:n,data:"Provider Popup Blocked"}))}),35)}))},t}(),x=function(e){var t=e.width||500,o=e.height||500,n=(0,w.default)({width:t,height:o,left:P.PLATFORM.global.screenX+(P.PLATFORM.global.outerWidth-t)/2,top:P.PLATFORM.global.screenY+(P.PLATFORM.global.outerHeight-o)/2.5},e),i=[];return Object.keys(n).map((function(e){return i.push(e+"="+n[e])})),i.join(",")},N=function(e){var t="#"===e.hash.charAt(0)?e.hash.substr(1):e.hash;return(0,w.default)(!0,{},(0,j.parseQueryString)(e.search),(0,j.parseQueryString)(t))},q=t.logger=(0,C.getLogger)("aurelia-authentication"),V=t.BaseConfig=function(){function e(){this.client=null,this.endpoint=null,this.configureEndpoints=null,this.loginRedirect="#/",this.logoutRedirect="#/",this.loginRoute="/login",this.loginOnSignup=!0,this.signupRedirect="#/login",this.expiredRedirect="#/",this.storageChangedRedirect="#/",this.baseUrl="",this.loginUrl="/auth/login",this.logoutUrl=null,this.logoutMethod="get",this.signupUrl="/auth/signup",this.profileUrl="/auth/me",this.profileMethod="put",this.unlinkUrl="/auth/unlink/",this.unlinkMethod="get",this.refreshTokenUrl=null,this.authHeader="Authorization",this.authTokenType="Bearer",this.logoutOnInvalidToken=!1,this.accessTokenProp="access_token",this.accessTokenName="token",this.accessTokenRoot=!1,this.useRefreshToken=!1,this.autoUpdateToken=!0,this.clientId=!1,this.clientSecret=null,this.refreshTokenProp="refresh_token",this.refreshTokenSubmitProp="refresh_token",this.keepOldResponseProperties=!1,this.refreshTokenName="token",this.refreshTokenRoot=!1,this.idTokenProp="id_token",this.idTokenName="token",this.idTokenRoot=!1,this.httpInterceptor=!0,this.withCredentials=!0,this.platform="browser",this.storage="localStorage",this.storageKey="aurelia_authentication",this.storageChangedReload=!1,this.getExpirationDateFromResponse=null,this.getAccessTokenFromResponse=null,this.getRefreshTokenFromResponse=null,this.globalValueConverters=["authFilterValueConverter"],this.defaultHeadersForTokenRequests={"Content-Type":"application/json"},this.providers={facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.5/dialog/oauth",redirectUri:P.PLATFORM.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",display:"popup",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:P.PLATFORM.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display","state"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633},state:W},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:P.PLATFORM.location.origin,optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:P.PLATFORM.location.origin,requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",oauthType:"2.0"},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/uas/oauth2/authorization",redirectUri:P.PLATFORM.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",oauthType:"2.0",popupOptions:{width:527,height:582}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",redirectUri:P.PLATFORM.location.origin,oauthType:"1.0",popupOptions:{width:495,height:645}},twitch:{name:"twitch",url:"/auth/twitch",authorizationEndpoint:"https://api.twitch.tv/kraken/oauth2/authorize",redirectUri:P.PLATFORM.location.origin,requiredUrlParams:["scope"],scope:["user_read"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:P.PLATFORM.location.origin,requiredUrlParams:["display","scope"],scope:["wl.emails"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},yahoo:{name:"yahoo",url:"/auth/yahoo",authorizationEndpoint:"https://api.login.yahoo.com/oauth2/request_auth",redirectUri:P.PLATFORM.location.origin,scope:[],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:559,height:519}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:P.PLATFORM.location.origin+"/",requiredUrlParams:["scope"],scope:["email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1028,height:529}},azure_ad:{name:"azure_ad",url:"/auth/azure_ad",authorizationEndpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",redirectUri:window.location.origin,logoutEndpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",postLogoutRedirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["user.read"],scopeDelimiter:" ",oauthType:"2.0"},auth0:{name:"auth0",oauthType:"auth0-lock",clientId:"your_client_id",clientDomain:"your_domain_url",display:"popup",lockOptions:{},responseType:"token",state:W}},this._authToken="Bearer",this._responseTokenProp="access_token",this._tokenName="token",this._tokenRoot=!1,this._tokenPrefix="aurelia",this._logoutOnInvalidtoken=!1}return e.prototype.joinBase=function(e){return(0,j.join)(this.baseUrl,e)},e.prototype.configure=function(e){for(var t in e)if(e.hasOwnProperty(t)){var o=e[t];void 0!==o&&(Array.isArray(o)||"object"!==(void 0===o?"undefined":A(o))||null===o?this[t]=o:(0,w.default)(!0,this[t],o))}},e.prototype.getOptionsForTokenRequests=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.default)(!0,{},{headers:this.defaultHeadersForTokenRequests},e)},O(e,[{key:"authToken",set:function(e){return q.warn("BaseConfig.authToken is deprecated. Use BaseConfig.authTokenType instead."),this._authTokenType=e,this.authTokenType=e,e},get:function(){return this._authTokenType}},{key:"responseTokenProp",set:function(e){return q.warn("BaseConfig.responseTokenProp is deprecated. Use BaseConfig.accessTokenProp instead."),this._responseTokenProp=e,this.accessTokenProp=e,e},get:function(){return this._responseTokenProp}},{key:"tokenRoot",set:function(e){return q.warn("BaseConfig.tokenRoot is deprecated. Use BaseConfig.accessTokenRoot instead."),this._tokenRoot=e,this.accessTokenRoot=e,e},get:function(){return this._tokenRoot}},{key:"tokenName",set:function(e){return q.warn("BaseConfig.tokenName is deprecated. Use BaseConfig.accessTokenName instead."),this._tokenName=e,this.accessTokenName=e,e},get:function(){return this._tokenName}},{key:"tokenPrefix",set:function(e){return q.warn("BaseConfig.tokenPrefix is obsolete. Use BaseConfig.storageKey instead."),this._tokenPrefix=e,e},get:function(){return this._tokenPrefix||"aurelia"}},{key:"current",get:function(){return q.warn("Getter BaseConfig.current is deprecated. Use BaseConfig directly instead."),this},set:function(e){throw new Error("Setter BaseConfig.current has been removed. Use BaseConfig directly instead.")}},{key:"_current",get:function(){return q.warn("Getter BaseConfig._current is deprecated. Use BaseConfig directly instead."),this},set:function(e){throw new Error("Setter BaseConfig._current has been removed. Use BaseConfig directly instead.")}},{key:"logoutOnInvalidtoken",set:function(e){return q.warn("BaseConfig.logoutOnInvalidtoken is obsolete. Use BaseConfig.logoutOnInvalidToken instead."),this._logoutOnInvalidtoken=e,this.logoutOnInvalidToken=e,e},get:function(){return this._logoutOnInvalidtoken}}]),e}();function W(){var e=Math.random().toString(36).substr(2);return encodeURIComponent(e)}var H=t.Storage=(0,S.inject)(V)(n=function(){function e(e){this.config=e}return e.prototype.get=function(e){return P.PLATFORM.global[this.config.storage].getItem(e)},e.prototype.set=function(e,t){P.PLATFORM.global[this.config.storage].setItem(e,t)},e.prototype.remove=function(e){P.PLATFORM.global[this.config.storage].removeItem(e)},e}())||n,Q=t.AuthLock=(0,S.inject)(H,V)(i=function(){function t(e,t){this.storage=e,this.config=t,this.defaults={name:null,state:null,scope:null,scopeDelimiter:" ",redirectUri:null,clientId:null,clientDomain:null,display:"popup",lockOptions:{},popupOptions:null,responseType:"token"}}return t.prototype.open=function(t,o){var n=this;if("function"!=typeof P.PLATFORM.global.Auth0Lock)throw new Error("Auth0Lock was not found in global scope. Please load it before using this provider.");var i=(0,w.default)(!0,{},this.defaults,t),r=i.name+"_state";"function"==typeof i.state?this.storage.set(r,i.state()):"string"==typeof i.state&&this.storage.set(r,i.state);var s={auth:{params:{}}};Array.isArray(i.scope)&&i.scope.length&&(s.auth.params.scope=i.scope.join(i.scopeDelimiter)),i.state&&(s.auth.params.state=this.storage.get(i.name+"_state")),"popup"===i.display?s.auth.redirect=!1:"string"==typeof i.redirectUri&&(s.auth.redirect=!0,s.auth.redirectUrl=i.redirectUri),"object"===A(i.popupOptions)&&(s.popupOptions=i.popupOptions),"string"==typeof i.responseType&&(s.auth.responseType=i.responseType);var a=(0,w.default)(!0,{},i.lockOptions,s);return this.lock=this.lock||new P.PLATFORM.global.Auth0Lock(i.clientId,i.clientDomain,a),new e((function(e,t){n.lock.on("authenticated",(function(t){a.auth.redirect||n.lock.hide(),e({access_token:t.accessToken,id_token:t.idToken})})),n.lock.on("unrecoverable_error",(function(e){a.auth.redirect||n.lock.hide(),t(e)})),n.lock.show()})).then((function(e){if("token"===i.responseType||"id_token%20token"===i.responseType||"token%20id_token"===i.responseType||"token id_token"===i.responseType)return e;throw new Error("Only `token` responseType is supported")}))},t}())||i,K=t.OAuth1=(0,S.inject)(H,B,V)(r=function(){function e(e,t,o){this.storage=e,this.config=o,this.popup=t,this.defaults={url:null,name:null,popupOptions:null,redirectUri:null,authorizationEndpoint:null}}return e.prototype.open=function(e,t){var o=this,n=(0,w.default)(!0,{},this.defaults,e),i=this.config.joinBase(n.url);return"mobile"!==this.config.platform&&(this.popup=this.popup.open("",n.name,n.popupOptions)),this.config.client.post(i).then((function(e){var i=n.authorizationEndpoint+"?"+(0,j.buildQueryString)(e);return"mobile"===o.config.platform?o.popup=o.popup.open(i,n.name,n.popupOptions):o.popup.popupWindow.location=i,("mobile"===o.config.platform?o.popup.eventListener(n.redirectUri):o.popup.pollPopup()).then((function(e){return o.exchangeForToken(e,t,n)}))}))},e.prototype.exchangeForToken=function(e,t,o){var n=(0,w.default)(!0,{},t,e),i=this.config.joinBase(o.url),r=this.config.withCredentials?"include":"same-origin";return this.config.client.post(i,n,{credentials:r})},e}())||r,G=t.OAuth2=(0,S.inject)(H,B,V)(s=function(){function t(e,t,o){this.storage=e,this.config=o,this.popup=t,this.defaults={url:null,name:null,state:null,scope:null,scopeDelimiter:null,redirectUri:null,popupOptions:null,authorizationEndpoint:null,responseParams:null,requiredUrlParams:null,optionalUrlParams:null,defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code"}}return t.prototype.open=function(t,o){var n=this,i=(0,w.default)(!0,{},this.defaults,t),r=i.name+"_state";"function"==typeof i.state?this.storage.set(r,i.state()):"string"==typeof i.state&&this.storage.set(r,i.state);var s=i.authorizationEndpoint+"?"+(0,j.buildQueryString)(this.buildQuery(i)),a=this.popup.open(s,i.name,i.popupOptions);return("mobile"===this.config.platform?a.eventListener(i.redirectUri):a.pollPopup()).then((function(t){return"token"===i.responseType||"id_token token"===i.responseType||"token id_token"===i.responseType?t:t.state&&t.state!==n.storage.get(r)?e.reject("OAuth 2.0 state parameter mismatch."):n.exchangeForToken(t,o,i)}))},t.prototype.exchangeForToken=function(e,t,o){var n=(0,w.default)(!0,{},t,{clientId:o.clientId,redirectUri:o.redirectUri},e),i=this.config.joinBase(o.url),r=this.config.withCredentials?"include":"same-origin";return this.config.client.post(i,n,{credentials:r})},t.prototype.buildQuery=function(e){var t=this,o={};return["defaultUrlParams","requiredUrlParams","optionalUrlParams"].forEach((function(n){(e[n]||[]).forEach((function(n){var i=n.replace(/([:\-_]+(.))/g,(function(e,t,o,n){return n?o.toUpperCase():o})),r="function"==typeof e[n]?e[n]():e[i];"state"===n&&(r=encodeURIComponent(t.storage.get(e.name+"_state"))),"scope"===n&&Array.isArray(r)&&(r=r.join(e.scopeDelimiter),e.scopePrefix&&(r=e.scopePrefix+e.scopeDelimiter+r)),o[n]=r}))})),o},t.prototype.close=function(e){var t=(0,w.default)(!0,{},this.defaults,e),o=t.logoutEndpoint+"?"+(0,j.buildQueryString)(this.buildLogoutQuery(t)),n=this.popup.open(o,t.name,t.popupOptions);return"mobile"===this.config.platform?n.eventListener(t.postLogoutRedirectUri):n.pollPopup()},t.prototype.buildLogoutQuery=function(e){var t={},o=this.storage.get(this.config.storageKey);return e.postLogoutRedirectUri&&(t.post_logout_redirect_uri=e.postLogoutRedirectUri),this.storage.get(e.name+"_state")&&(t.state=this.storage.get(e.name+"_state")),JSON.parse(o).id_token&&(t.id_token_hint=JSON.parse(o).id_token),t},t}())||s;var J=t.Authentication=(a=(0,S.inject)(H,V,K,G,Q),u=(0,F.deprecated)({message:"Use baseConfig.loginRoute instead."}),c=(0,F.deprecated)({message:"Use baseConfig.loginRedirect instead."}),p=(0,F.deprecated)({message:"Use baseConfig.joinBase(baseConfig.loginUrl) instead."}),h=(0,F.deprecated)({message:"Use baseConfig.joinBase(baseConfig.signupUrl) instead."}),l=(0,F.deprecated)({message:"Use baseConfig.joinBase(baseConfig.profileUrl) instead."}),g=(0,F.deprecated)({message:"Use .getAccessToken() instead."}),a((z((f=function(){function t(e,t,o,n,i){this.storage=e,this.config=t,this.oAuth1=o,this.oAuth2=n,this.auth0Lock=i,this.updateTokenCallstack=[],this.accessToken=null,this.refreshToken=null,this.idToken=null,this.payload=null,this.exp=null,this.responseAnalyzed=!1}return t.prototype.getLoginRoute=function(){return this.config.loginRoute},t.prototype.getLoginRedirect=function(){return this.config.loginRedirect},t.prototype.getLoginUrl=function(){return this.Config.joinBase(this.config.loginUrl)},t.prototype.getSignupUrl=function(){return this.Config.joinBase(this.config.signupUrl)},t.prototype.getProfileUrl=function(){return this.Config.joinBase(this.config.profileUrl)},t.prototype.getToken=function(){return this.getAccessToken()},t.prototype.getResponseObject=function(){return JSON.parse(this.storage.get(this.config.storageKey))},t.prototype.setResponseObject=function(e){if(e){if(this.config.keepOldResponseProperties){var t=this.getResponseObject();e=Object.assign({},t,e)}return this.getDataFromResponse(e),void this.storage.set(this.config.storageKey,JSON.stringify(e))}this.accessToken=null,this.refreshToken=null,this.idToken=null,this.payload=null,this.exp=null,this.responseAnalyzed=!1,this.storage.remove(this.config.storageKey)},t.prototype.getAccessToken=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.accessToken},t.prototype.getRefreshToken=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.refreshToken},t.prototype.getIdToken=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.idToken},t.prototype.getPayload=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.payload},t.prototype.getIdPayload=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.idPayload},t.prototype.getExp=function(){return this.responseAnalyzed||this.getDataFromResponse(this.getResponseObject()),this.exp},t.prototype.getTtl=function(){var e=this.getExp();return Number.isNaN(e)?NaN:e-Math.round((new Date).getTime()/1e3)},t.prototype.isTokenExpired=function(){var e=this.getTtl();return Number.isNaN(e)?void 0:e<0},t.prototype.isAuthenticated=function(){return!!this.getAccessToken()&&!this.isTokenExpired()},t.prototype.getDataFromResponse=function(e){var t=this.config;if(this.accessToken="function"==typeof this.config.getAccessTokenFromResponse?this.config.getAccessTokenFromResponse(e):this.getTokenFromResponse(e,t.accessTokenProp,t.accessTokenName,t.accessTokenRoot),this.refreshToken=null,t.useRefreshToken)try{this.refreshToken="function"==typeof this.config.getRefreshTokenFromResponse?this.config.getRefreshTokenFromResponse(e):this.getTokenFromResponse(e,t.refreshTokenProp,t.refreshTokenName,t.refreshTokenRoot)}catch(e){this.refreshToken=null,q.warn("useRefreshToken is set, but could not extract a refresh token")}this.idToken=null;try{this.idToken=this.getTokenFromResponse(e,t.idTokenProp,t.idTokenName,t.idTokenRoot)}catch(e){this.idToken=null}return this.payload=X(this.accessToken),this.idPayload=X(this.idToken),this.exp=parseInt("function"==typeof this.config.getExpirationDateFromResponse?this.config.getExpirationDateFromResponse(e):this.payload&&this.payload.exp,10)||NaN,this.responseAnalyzed=!0,{accessToken:this.accessToken,refreshToken:this.refreshToken,idToken:this.idToken,payload:this.payload,exp:this.exp}},t.prototype.getTokenFromResponse=function(e,t,o,n){if(e){var i=t.split(".").reduce((function(e,t){return e[t]}),e);if("string"==typeof i)return i;if("object"===(void 0===i?"undefined":A(i))){var r=n&&n.split(".").reduce((function(e,t){return e[t]}),i),s=r?r[o]:i[o];if(!s){var a=new Error("Token not found in response");throw a.responseObject=e,a}return s}var u=void 0===e[o]?null:e[o];if(!u){var c=new Error("Token not found in response");throw c.responseObject=e,c}return u}},t.prototype.toUpdateTokenCallstack=function(){var t=this;return new e((function(e){return t.updateTokenCallstack.push(e)}))},t.prototype.resolveUpdateTokenCallstack=function(e){this.updateTokenCallstack.map((function(t){return t(e)})),this.updateTokenCallstack=[]},t.prototype.authenticate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.config.providers[e].type;o?q.warn("DEPRECATED: Setting provider.type is deprecated and replaced by provider.oauthType"):o=this.config.providers[e].oauthType;return("auth0-lock"===o?this.auth0Lock:"1.0"===o?this.oAuth1:this.oAuth2).open(this.config.providers[e],t)},t.prototype.logout=function(t){var o=e.resolve("Not Applicable");return"2.0"===this.config.providers[t].oauthType&&this.config.providers[t].logoutEndpoint?this.oAuth2.close(this.config.providers[t]):o},t.prototype.redirect=function(e,t,o){!0!==e?(!1===e&&q.warn("BREAKING CHANGE: Setting redirectUrl === false to actually *do redirect* is deprecated. Set redirectUrl to undefined or null to use the defaultRedirectUrl if so desired."),0!==e?""!==e&&("string"==typeof e?P.PLATFORM.location.href=encodeURI(e+(o?"?"+(0,j.buildQueryString)(o):"")):t&&(P.PLATFORM.location.href=t+(o?"?"+(0,j.buildQueryString)(o):""))):q.warn("BREAKING CHANGE: Setting redirectUrl === 0 is deprecated. Set redirectUrl to '' instead.")):q.warn("DEPRECATED: Setting redirectUrl === true to actually *not redirect* is deprecated. Set redirectUrl === '' instead.")},O(t,[{key:"responseObject",get:function(){return q.warn("Getter Authentication.responseObject is deprecated. Use Authentication.getResponseObject() instead."),this.getResponseObject()},set:function(e){q.warn("Setter Authentication.responseObject is deprecated. Use AuthServive.setResponseObject(response) instead."),this.setResponseObject(e)}},{key:"hasDataStored",get:function(){return q.warn("Authentication.hasDataStored is deprecated. Use Authentication.responseAnalyzed instead."),this.responseAnalyzed}}]),t}()).prototype,"getLoginRoute",[u],Object.getOwnPropertyDescriptor(f.prototype,"getLoginRoute"),f.prototype),z(f.prototype,"getLoginRedirect",[c],Object.getOwnPropertyDescriptor(f.prototype,"getLoginRedirect"),f.prototype),z(f.prototype,"getLoginUrl",[p],Object.getOwnPropertyDescriptor(f.prototype,"getLoginUrl"),f.prototype),z(f.prototype,"getSignupUrl",[h],Object.getOwnPropertyDescriptor(f.prototype,"getSignupUrl"),f.prototype),z(f.prototype,"getProfileUrl",[l],Object.getOwnPropertyDescriptor(f.prototype,"getProfileUrl"),f.prototype),z(f.prototype,"getToken",[g],Object.getOwnPropertyDescriptor(f.prototype,"getToken"),f.prototype),d=f))||d);function X(e){var t=null;try{t=e?(0,U.default)(e):null}catch(e){}return t}var Y=t.AuthService=(k=(0,S.inject)(J,V,L.BindingSignaler,_.EventAggregator),y=(0,F.deprecated)({message:"Use .getAccessToken() instead."}),k((z((v=function(){function t(e,t,o,n){var i=this;this.authenticated=!1,this.timeoutID=0,this.storageEventHandler=function(e){if(e.key===i.config.storageKey&&e.newValue!==e.oldValue)if(e.newValue?i.authentication.storage.set(i.config.storageKey,e.newValue):i.authentication.storage.remove(i.config.storageKey),e.newValue&&i.config.autoUpdateToken&&i.authentication.getAccessToken()&&i.authentication.getRefreshToken())i.setResponseObject(i.authentication.getResponseObject());else{q.info("Stored token changed event");var t=i.authenticated;i.authentication.responseAnalyzed=!1,i.updateAuthenticated(),t!==i.authenticated&&(i.config.storageChangedRedirect&&(P.PLATFORM.location.href=i.config.storageChangedRedirect),i.config.storageChangedReload&&P.PLATFORM.location.reload())}},this.authentication=e,this.config=t,this.bindingSignaler=o,this.eventAggregator=n;var r=t.tokenPrefix?t.tokenPrefix+"_"+t.tokenName:t.tokenName,s=e.storage.get(r);if(s){q.info("Found token with deprecated format in storage. Converting it to new format. No further action required.");var a={};a[t.accessTokenProp]=s,this.setResponseObject(a),e.storage.remove(r)}this.setResponseObject(this.authentication.getResponseObject()),P.PLATFORM.addEventListener("storage",this.storageEventHandler)}return t.prototype.setTimeout=function(e){var t=this;e>2147483647&&(e=2147483647,q.warn("Token timeout limited to ",2147483647," ms (ca 24.85d).")),this.clearTimeout();var o=function(){t.config.autoUpdateToken&&t.authentication.getAccessToken()&&t.authentication.getRefreshToken()?t.updateToken().catch((function(e){return q.warn(e.message)})):(t.setResponseObject(null),t.config.expiredRedirect&&P.PLATFORM.location.assign(t.config.expiredRedirect))};this.timeoutID=P.PLATFORM.global.setTimeout(o,e),P.PLATFORM.addEventListener("focus",(function(){t.isTokenExpired()&&o()}))},t.prototype.clearTimeout=function(){this.timeoutID&&P.PLATFORM.global.clearTimeout(this.timeoutID),this.timeoutID=0},t.prototype.setResponseObject=function(e){this.authentication.setResponseObject(e),this.updateAuthenticated()},t.prototype.updateAuthenticated=function(){this.clearTimeout();var e=this.authenticated;this.authenticated=this.authentication.isAuthenticated(),this.authenticated&&!Number.isNaN(this.authentication.exp)&&this.setTimeout(1e3*this.getTtl()),e!==this.authenticated&&(this.bindingSignaler.signal("authentication-change"),this.eventAggregator.publish("authentication-change",this.authenticated),q.info("Authorization changed to: "+this.authenticated))},t.prototype.getMe=function(e){return"string"!=typeof e&&"number"!=typeof e||(e={id:e}),this.client.find(this.config.joinBase(this.config.profileUrl),e)},t.prototype.updateMe=function(e,t){return"string"!=typeof t&&"number"!=typeof t||(t={id:t}),"put"===this.config.profileMethod?this.client.update(this.config.joinBase(this.config.profileUrl),t,e):this.client.patch(this.config.joinBase(this.config.profileUrl),t,e)},t.prototype.getAccessToken=function(){return this.authentication.getAccessToken()},t.prototype.getCurrentToken=function(){return this.getAccessToken()},t.prototype.getRefreshToken=function(){return this.authentication.getRefreshToken()},t.prototype.getIdToken=function(){return this.authentication.getIdToken()},t.prototype.isAuthenticated=function(e){var t=this;this.authentication.responseAnalyzed=!1;var o=this.authentication.isAuthenticated();return!o&&this.config.autoUpdateToken&&this.authentication.getAccessToken()&&this.authentication.getRefreshToken()?(this.updateToken().then((function(){"function"==typeof e&&e(t.authenticated)})).catch((function(e){return q.warn(e.message)})),o=!0):"function"==typeof e&&P.PLATFORM.global.setTimeout((function(){try{e(o)}catch(e){q.warn(e.message)}}),1),o},t.prototype.getExp=function(){return this.authentication.getExp()},t.prototype.getTtl=function(){return this.authentication.getTtl()},t.prototype.isTokenExpired=function(){return this.authentication.isTokenExpired()},t.prototype.getTokenPayload=function(){return this.authentication.getPayload()},t.prototype.getIdTokenPayload=function(){return this.authentication.getIdPayload()},t.prototype.updateToken=function(){var t=this;if(!this.authentication.getRefreshToken())return e.reject(new Error("refreshToken not set"));if(0===this.authentication.updateTokenCallstack.length){var o={grant_type:"refresh_token"};this.config.clientId&&(o.client_id=this.config.clientId),this.config.clientSecret&&(o.client_secret=this.config.clientSecret),o[this.config.refreshTokenSubmitProp]=this.authentication.getRefreshToken(),this.client.post(this.config.joinBase(this.config.refreshTokenUrl?this.config.refreshTokenUrl:this.config.loginUrl),o,this.config.getOptionsForTokenRequests()).then((function(o){t.setResponseObject(o),t.getAccessToken()?t.authentication.resolveUpdateTokenCallstack(t.isAuthenticated()):(t.setResponseObject(null),t.config.expiredRedirect&&P.PLATFORM.location.assign(t.config.expiredRedirect),t.authentication.resolveUpdateTokenCallstack(e.reject(new Error("accessToken not found in refreshToken response"))))})).catch((function(o){t.setResponseObject(null),t.config.expiredRedirect&&P.PLATFORM.location.assign(t.config.expiredRedirect),t.authentication.resolveUpdateTokenCallstack(e.reject(o))}))}return this.authentication.toUpdateTokenCallstack()},t.prototype.signup=function(e,t,o,n,i){var r=this,s={};return"object"===(void 0===e?"undefined":A(e))?(s.credentials=e,s.options=t,s.redirectUri=o):(s.credentials={displayName:e,email:t,password:o},s.options=n,s.redirectUri=i),this.client.post(this.config.joinBase(this.config.signupUrl),s.credentials,s.options).then((function(e){return r.config.loginOnSignup&&r.setResponseObject(e),r.authentication.redirect(s.redirectUri,r.config.signupRedirect),e}))},t.prototype.login=function(e,t,o,n){var i=this,r={};return"object"===(void 0===e?"undefined":A(e))?(r.credentials=e,r.options=this.config.getOptionsForTokenRequests(t),r.redirectUri=o):"string"==typeof e&&(r.credentials={email:e,password:t},r.options=this.config.getOptionsForTokenRequests(o),r.redirectUri=n),this.config.clientId&&(r.credentials.client_id=this.config.clientId),this.config.clientSecret&&(r.credentials.client_secret=this.config.clientSecret),this.client.post(this.config.joinBase(this.config.loginUrl),r.credentials,r.options).then((function(e){return i.setResponseObject(e),i.authentication.redirect(r.redirectUri,i.config.loginRedirect),e}))},t.prototype.logout=function(t,o,n){var i=this,r=function(n){return new e((function(e){i.setResponseObject(null),i.authentication.redirect(t,i.config.logoutRedirect,o),"function"==typeof i.onLogout&&i.onLogout(n),e(n)}))};return n?this.config.providers[n].logoutEndpoint?this.authentication.logout(n).then((function(t){var o=i.authentication.storage.get(n+"_state");return t.state!==o?e.reject("OAuth2 response state value differs"):r(t)})):void 0:this.config.logoutUrl?this.client.request(this.config.logoutMethod,this.config.joinBase(this.config.logoutUrl)).then(r).catch(r):r()},t.prototype.authenticate=function(e,t,o){var n=this;return this.authentication.authenticate(e,o).then((function(e){return n.setResponseObject(e),n.authentication.redirect(t,n.config.loginRedirect),e}))},t.prototype.unlink=function(e,t){var o=this,n=this.config.joinBase(this.config.unlinkUrl)+e;return this.client.request(this.config.unlinkMethod,n).then((function(e){return o.authentication.redirect(t),e}))},O(t,[{key:"client",get:function(){return this.config.client}},{key:"auth",get:function(){return q.warn("AuthService.auth is deprecated. Use .authentication instead."),this.authentication}}]),t}()).prototype,"getCurrentToken",[y],Object.getOwnPropertyDescriptor(v.prototype,"getCurrentToken"),v.prototype),T=v))||T),Z=(t.AuthenticateStep=(0,S.inject)(Y)(m=function(){function e(e){this.authService=e}return e.prototype.run=function(e,t){var o=this.authService.authenticated,n=this.authService.config.loginRoute;if(e.getAllInstructions().some((function(e){return!0===e.config.auth}))){if(!o)return t.cancel(new M.Redirect(n))}else if(o&&e.getAllInstructions().some((function(e){return e.fragment===n})))return t.cancel(new M.Redirect(this.authService.config.loginRedirect));return t()},e}())||m,t.AuthorizeStep=(0,S.inject)(Y)(R=function(){function e(e){q.warn("AuthorizeStep is deprecated. Use AuthenticateStep instead."),this.authService=e}return e.prototype.run=function(e,t){var o=this.authService.isAuthenticated(),n=this.authService.config.loginRoute;if(e.getAllInstructions().some((function(e){return e.config.auth}))){if(!o)return t.cancel(new M.Redirect(n))}else if(o&&e.getAllInstructions().some((function(e){return e.fragment===n})))return t.cancel(new M.Redirect(this.authService.config.loginRedirect));return t()},e}())||R,t.FetchConfig=(0,S.inject)(D.HttpClient,E.Config,Y,V)(b=function(){function t(e,t,o,n){this.httpClient=e,this.clientConfig=t,this.authService=o,this.config=n}return t.prototype.configure=function(e){var t=this;if(Array.isArray(e)){var o=[];return e.forEach((function(e){o.push(t.configure(e))})),o}if("string"==typeof e){var n=this.clientConfig.getEndpoint(e);if(!n)throw new Error("There is no '"+(e||"default")+"' endpoint registered.");e=n.client}else e instanceof E.Rest?e=e.client:e instanceof D.HttpClient||(e=this.httpClient);return e.interceptors.push(this.interceptor),e},O(t,[{key:"interceptor",get:function(){var t=this;return{request:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(!t.config.httpInterceptor||!t.authService.isAuthenticated())return e;var o=t.authService.getAccessToken();return t.config.authTokenType&&(o=t.config.authTokenType+" "+o),e.headers.set(t.config.authHeader,o),e})),response:function(e){function t(t,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(o,n){return new e((function(e,i){return o.ok||401!==o.status?e(o):t.authService.authenticated?t.config.httpInterceptor&&t.config.logoutOnInvalidToken&&!t.authService.isTokenExpired()?i(t.authService.logout()):t.config.httpInterceptor&&t.authService.isTokenExpired()&&t.config.useRefreshToken&&t.authService.getRefreshToken()?void e(t.authService.updateToken().then((function(){var o=t.authService.getAccessToken();return t.config.authTokenType&&(o=t.config.authTokenType+" "+o),n.headers.set(t.config.authHeader,o),t.httpClient.fetch(n).then(e)}))):e(o):i(o)}))}))}}}]),t}())||b)}).call(this,o("B/eG").default)},"aurelia-authentication/authFilterValueConverter":function(e,t,o){"use strict";t.__esModule=!0,t.AuthFilterValueConverter=void 0;o("4ysu"),t.AuthFilterValueConverter=function(){function e(){}return e.prototype.toView=function(e,t){return e.filter((function(e){return"boolean"!=typeof e.config.auth||e.config.auth===t}))},e}()}}]);
//# sourceMappingURL=vendor.aurelia-authentication~9a0e1245.ff98528e70e02c426d60.bundle.map