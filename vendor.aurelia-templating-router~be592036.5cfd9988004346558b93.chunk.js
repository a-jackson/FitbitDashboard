(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"aurelia-templating-router":function(t,e,o){"use strict";(function(t){o.d(e,"configure",function(){return g});var n=o("4ysu"),i=o("qrcG"),r=o("iD3O"),u=o("hij8"),a=o("3U8n"),c=o("X5gX"),s=o("70NS"),l=o("MP1E"),p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};var h=function(){},f=function(){function e(t,e,o,n,i,r,u){this.element=t,this.container=e,this.viewSlot=o,this.router=n,this.viewLocator=i,this.compositionTransaction=r,this.compositionEngine=u,this.router.registerViewPort(this,this.element.getAttribute("name")),"initialComposition"in r||(r.initialComposition=!0,this.compositionTransactionNotifier=r.enlist())}return e.inject=function(){return[s.DOM.Element,a.Container,u.p,n.Router,u.n,u.f,u.e]},e.prototype.created=function(t){this.owningView=t},e.prototype.bind=function(t,e){this.container.viewModel=t,this.overrideContext=e},e.prototype.process=function(t,e){var o=this,n=t,r=n.component,a=r.childContainer,c=r.viewModel,s=r.viewModelResource,l=s.metadata,p=r.router.currentInstruction.config,h=p.viewPorts&&p.viewPorts[n.name]||{};a.get(d)._notify(this);var f={viewModel:h.layoutViewModel||p.layoutViewModel||this.layoutViewModel,view:h.layoutView||p.layoutView||this.layoutView,model:h.layoutModel||p.layoutModel||this.layoutModel,router:n.component.router,childContainer:a,viewSlot:this.viewSlot},w=this.viewLocator.getViewStrategy(r.view||c);return w&&r.view&&w.makeRelativeTo(i.Origin.get(r.router.container.viewModel.constructor).moduleId),l.load(a,s.value,null,w,!0).then(function(t){o.compositionTransactionNotifier||(o.compositionTransactionOwnershipToken=o.compositionTransaction.tryCapture()),(f.viewModel||f.view)&&(n.layoutInstruction=f);var i=u.b.dynamic(o.element,c,t);if(n.controller=l.create(a,i),e)return null;o.swap(n)})},e.prototype.swap=function(e){var o=this,n=e,i=n.controller,r=n.layoutInstruction,a=this.view,s=function(){var e=u.i[o.swapOrder]||u.i.after,n=o.viewSlot;e(n,a,function(){return t.resolve(n.add(o.view))}).then(function(){o._notify()})},l=function(t){i.automate(o.overrideContext,t);var e=o.compositionTransactionOwnershipToken;return e?e.waitForCompositionComplete().then(function(){return o.compositionTransactionOwnershipToken=null,s()}):s()};return r?(r.viewModel||(r.viewModel=new h),this.compositionEngine.createController(r).then(function(t){var e=t.view;return u.h.distributeView(i.view,t.slots||e.slots),t.automate(Object(c.u)(r.viewModel),o.owningView),e.children.push(i.view),e||t}).then(function(t){return o.view=t,l(t)})):(this.view=i.view,l(this.owningView))},e.prototype._notify=function(){var t=this.compositionTransactionNotifier;t&&(t.done(),this.compositionTransactionNotifier=null)},e.$view=null,e.$resource={name:"router-view",bindables:["swapOrder","layoutView","layoutViewModel","layoutModel","inherit-binding-context"]},e}(),d=function(){function e(){var e=this;this.promise=new t(function(t){return e.resolve=t})}return e.prototype.findNearest=function(){return this.promise},e.prototype._notify=function(t){this.resolve(t)},e}(),w=function(){};u.t("<template></template>")(w);var v=function(e){function o(t){var o=e.call(this)||this;return o.compositionEngine=t,o}return function(t,e){function o(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}(o,e),o.prototype.resolveViewModel=function(e,o){return new t(function(t,n){var a;if("moduleId"in o){var c=o.moduleId;return null===c?a=w:(c=Object(r.relativeToFile)(c,i.Origin.get(e.container.viewModel.constructor).moduleId),a=/\.html/i.test(c)?function(t){var e=/([^\/^\?]+)\.html/i.exec(t)[1],o=function(){function t(){}return t.prototype.bind=function(t){this.$parent=t},t}();return Object(u.s)(e)(o),Object(u.y)(t)(o),o}(c):c),t(a)}n(new Error('Invalid route config. No "moduleId" found.'))})},o.prototype.createChildContainer=function(t){var e=t.container.createChild();return e.registerSingleton(d),e.getChildRouter=function(){var o;return e.registerHandler(n.Router,function(){return o||(o=t.createChild(e))}),e.get(n.Router)},e},o.prototype.loadRoute=function(t,e,o){var n=this;return this.resolveViewModel(t,e).then(function(o){return n.compositionEngine.ensureViewModel({viewModel:o,childContainer:n.createChildContainer(t),view:e.view||e.viewStrategy,router:t})})},o.inject=[u.e],o}(n.RouteLoader);var m=Object(l.getLogger)("route-href"),y=function(){function t(t,e){this.router=t,this.element=e,this.attribute="href"}return t.inject=function(){return[n.Router,s.DOM.Element]},t.prototype.bind=function(){this.isActive=!0,this.processChange()},t.prototype.unbind=function(){this.isActive=!1},t.prototype.attributeChanged=function(t,e){return e&&this.element.removeAttribute(e),this.processChange()},t.prototype.processChange=function(){var t=this;return this.router.ensureConfigured().then(function(){if(!t.isActive)return null;var e=t.element,o=t.router.generate(t.route,t.params);return e.au.controller?e.au.controller.viewModel[t.attribute]=o:e.setAttribute(t.attribute,o),null}).catch(function(t){m.error(t)})},t.$resource={type:"attribute",name:"route-href",bindables:[{name:"route",changeHandler:"processChange",primaryProperty:!0},{name:"params",changeHandler:"processChange"},"attribute"]},t}();function g(t){t.singleton(n.RouteLoader,v).singleton(n.Router,n.AppRouter).globalResources(f,y),t.container.registerAlias(n.Router,n.AppRouter)}}).call(this,o("B/eG").default)}}]);
//# sourceMappingURL=vendor.aurelia-templating-router~be592036.5cfd9988004346558b93.bundle.map